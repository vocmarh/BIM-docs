# План реализации (WBS)

## Фаза 0. Каркас

- **Схема БД**  
  Используется существующая отработанная схема выгрузки Revit → MSSQL (таблицы `EL_Элементы`, `EL_EAV` и др.), применяемая на всех проектах. Дополнительного проектирования базы данных не требуется.  

- **Роли пользователей**  
  - **БИМ-отдел**  
    - отвечает за выгрузку параметров в БД;  
    - на первом этапе заполняет параметр `TOUCH_Классификатор`.  
  - **Проектировщик** (планируется в будущем)  
    - будет заполнять параметр `TOUCH_Классификатор`.  
  - **Начальник участка / ПТО**  
    - в Revit вручную заполняет `TOUCH_Фактическая_дата_начала`;  
    - в Revit вручную заполняет `TOUCH_Фактическая_дата_завершения`.  
  - **Инструмент (плагин)**  
    - автоматически заполняет `TOUCH_Плановая_дата_начала`;  
    - автоматически заполняет `TOUCH_Плановая_дата_завершения`;  
    - источником данных является ГПР и параметр `TOUCH_Классификатор`.  


## Фаза 1. Данные и модель

### Новые параметры в Revit:

- `TOUCH_Фактическая_дата_начала` — **начальник участка** (ручной ввод).  
- `TOUCH_Фактическая_дата_завершения` — **начальник участка** (ручной ввод).  
- `TOUCH_Плановая_дата_начала` — **плагин** (автоматическое заполнение на основе ГПР и классификатора).  
- `TOUCH_Плановая_дата_завершения` — **плагин** (автоматическое заполнение на основе ГПР и классификатора).  
- `TOUCH_Классификатор` — на первом этапе **БИМ-отдел**, в дальнейшем **проектировщик**.  

### Логика работы:

1. При выгрузке данных из Revit параметры сохраняются в существующую схему БД (EL_Элементы, EL_EAV).  
2. Начальник участка отвечает только за фактические даты.  
3. Плановые даты подтягиваются автоматически, исключая ручной ввод.  
4. Классификатор — ключ для сопоставления элементов с ГПР.  

## Фаза 2. Связка с ГПР
- Импорт задач MS Project (CSV/XML) в `ScheduleBindings` через n8n.
- Разнос плановых дат на элементы (`JOIN` по `ClassCode`).

## Фаза 3. Обновления моделей
- Перенос параметров `TOUCH_*` из старой модели в новую (по `ElementGuid`/геометрическим сигнатурам).

## Фаза 4. Визуализация (Power BI RS)
- Витрины `vw_Elements`, `vw_PlanFact`, `vw_StatusAgg`.
- 3D раскраска статусов, таймлайн, KPI по объёмам/отклонениям.

## Фаза 5. UX и обучение
- Dockable Pane с минимумом действий.
- Памятка 1‑страница и 5‑мин. видео.

## Фаза 6. Автоматизация (n8n)
- Ежедневный снапшот и KPI в Telegram.
- Импорт ГПР, валидатор классификатора, монитор новых RVT.

## Фаза 7. Эксплуатация
- SLA, метрики, регресс‑тесты.

> Для каждой задачи ведите DoD и тесты в `/docs/04.acceptance.md`.
